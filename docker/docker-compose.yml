version: '2'
services:
   # orion
  mongo:  
   image: mongo:3.4
   command: --nojournal
   volumes:
     - ./mongo/data:/data/db
  orion:
   image: fiware/orion:1.13.0
   depends_on:
    - mongo
   ports: 
    - "1026:1026"
   #environment:
   command:  -dbhost mongo
  
  nginx:
    #restart: always
   image: nginx:latest
   ports:
        - "8280:80"
   volumes:
        - ./nginx.conf:/etc/nginx/nginx.conf:ro
   volumes_from:
        - wirecloud
   links:
        - wirecloud:wirecloud

  postgres:
        #restart: always
     image: postgres:latest
     volumes_from:
        - data
     ports:
        - "5432:5432"

  data:
        #restart: always
        image: postgres:latest
        volumes:
            - ./postgres/data:/var/lib/postgresql
        command: /bin/true

  wirecloud:
        #restart: always
        image: fiware/wirecloud:latest-composable
        links:
            - postgres:postgres

        
